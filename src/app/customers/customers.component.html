<div class="container py-4">
  <div class="card border-0 shadow-sm">
    <div class="card-header bg-white py-3 d-flex justify-content-between align-items-center">
      <div>
        <h4 class="mb-0 fw-bold text-dark">Customers</h4>
        <p class="text-muted small mb-0">Manage your bank customers efficiently</p>
      </div>
      <a routerLink="/new-customer" class="btn btn-primary btn-sm px-3">
        <i class="bi bi-person-plus-fill me-1"></i> Add Customer
      </a>
    </div>
    <div class="card-body">
      <div *ngIf="searchFormGroup" class="mb-4">
        <form [formGroup]="searchFormGroup" (ngSubmit)="handleSearchCustomers()">
          <div class="input-group input-group-sm mx-auto" style="max-width: 500px;">
            <span class="input-group-text bg-white border-end-0">
              <i class="bi bi-search text-muted"></i>
            </span>
            <input type="text" formControlName="keyword" class="form-control border-start-0 ps-0 bg-white"
                   placeholder="Search customers by name or email...">
            <button class="btn btn-primary px-4" type="submit">
              Search
            </button>
          </div>
        </form>
      </div>

      <ng-container *ngIf="customers | async as listCustomers; else loadingOrError">
        <div *ngIf="listCustomers.length === 0" class="text-center py-5">
          <i class="bi bi-person-x fs-1 text-muted"></i>
          <p class="mt-2 text-muted">No customers found matching your search.</p>
        </div>
        <div class="table-responsive" *ngIf="listCustomers.length > 0">
          <table class="table table-hover align-middle mb-0">
            <thead>
              <tr>
                <th class="ps-4">Customer</th>
                <th>Email</th>
                <th class="text-end pe-4">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let c of listCustomers">
                <td class="ps-4">
                  <div class="d-flex align-items-center">
                    <div class="bg-light rounded-circle p-2 me-3 text-primary d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                      <i class="bi bi-person-fill fs-5"></i>
                    </div>
                    <div>
                      <div class="fw-bold text-dark">{{c.name}}</div>
                      <small class="text-muted">ID: {{c.id}}</small>
                    </div>
                  </div>
                </td>
                <td>
                  <span class="text-muted small">{{c.email}}</span>
                </td>
                <td class="text-end pe-4">
                  <div class="btn-group">
                    <button (click)="handleCustomerAccounts(c)" class="btn btn-outline-info btn-sm border-0" title="View Accounts">
                      <i class="bi bi-eye-fill"></i>
                    </button>
                    <button (click)="handleEditCustomer(c)" class="btn btn-outline-success btn-sm border-0" title="Edit">
                      <i class="bi bi-pencil-square"></i>
                    </button>
                    <button (click)="handleDeleteCustomer(c)" class="btn btn-outline-danger btn-sm border-0" title="Delete">
                      <i class="bi bi-trash3-fill"></i>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </ng-container>

      <ng-template #loadingOrError>
        <ng-container *ngIf="errorMessage; else loading">
          <div class="alert alert-danger border-0 shadow-sm mx-auto mt-4" style="max-width: 600px;">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>{{errorMessage}}
          </div>
        </ng-container>
        <ng-template #loading>
          <div class="text-center py-5">
            <div class="spinner-border text-primary spinner-border-sm" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3 text-muted small">Loading customer data...</p>
          </div>
        </ng-template>
      </ng-template>
    </div>
  </div>
</div>
